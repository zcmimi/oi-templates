<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <title>miller-rabin</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/zcmimi/cdn@master/material/assets/mdui/css/mdui.min.css">
    
    <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/highlightjs/cdn-release/build/styles/github.min.css">
    <script async src="//cdn.jsdelivr.net/gh/highlightjs/cdn-release/build/highlight.min.js"></script>
    
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/katex/dist/katex.min.css">
    <style>
        body,code{
            font-family: Monaco,Consolas,hack,"微软雅黑";
            font-size: 17px;
        }
    </style>
</head>
<body class="mdui-appbar-with-toolbar mdui-theme-accent-blue">
    <div class="mdui-appbar mdui-appbar-fixed mdui-appbar-scroll-hide mdui-appbar-inset mdui-color-white">
        <div class="mdui-toolbar mdui-color-theme">
            <a href="/" class="mdui-btn mdui-btn-icon"><i class="mdui-icon material-icons">home</i></a>
            <a href="//miller-rabin/.." class="mdui-btn mdui-btn-icon"><i class="mdui-icon material-icons">arrow_upward</i></a>
            <div class="mdui-typo-title">miller-rabin</div>
            <div class="mdui-toolbar-spacer"></div>
        </div>
    </div>

    <div class="mdui-container" style="padding-top: 50px">
<div class="mdui-card">
    <div class="mdui-card-content mdui-typo"><p><a href="http://acm.hdu.edu.cn/showproblem.php?pid=2138">HDU 2138 How many prime numbers</a></p>
</div>
</div>

<pre><code class="lang-cpp">
#include&lt;cstdio&gt;
int pw(int x,int b,int p){
    int res=1;
    while(b){
        if(b&amp;1)res=1ll*res*x%p;
        b&gt;&gt;=1;x=1ll*x*x%p;
    }
    return res;
}
bool chk(int p){
    if(p==2)return 1;
    if(p&lt;2||!(p&amp;1))return 0;
    static int test[]={2,3,5,7,11,13,17,19,23,29,31,37,41};
    int t=p-1,k=0;
    while(!(t&amp;1))++k,t&gt;&gt;=1;
    for(int i=0;i&lt;4&amp;&amp;test[i]&lt;p;++i){
        int a=pw(test[i],t,p),nxt;
        for(int j=1;j&lt;=k;++j){
            nxt=1ll*a*a%p;
            if(nxt==1&amp;&amp;a!=1&amp;&amp;a!=p-1)return 0;
            a=nxt;
        }
        if(a!=1)return 0;
    }
    return 1;
}
int main(){
    int T;
    while(~scanf(&#34;%d&#34;,&amp;T)){
        int x,ans=0;
        while(T--)scanf(&#34;%d&#34;,&amp;x),ans+=chk(x);
        printf(&#34;%d\n&#34;,ans);
    }
}</code></pre>
    </div>
</body>
<script async src="https://cdn.jsdelivr.net/gh/zcmimi/cdn@master/material/assets/mdui/js/mdui.min.js"></script>
<script src="//cdn.jsdelivr.net/npm/katex/dist/katex.min.js"></script>
<script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release/build/highlight.min.js"></script>
<script src="/assets/bundle.js"></script>
<script>katex_();highlight();</script>
</html>